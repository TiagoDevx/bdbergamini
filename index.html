<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload de Imagens</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        #drop-area {
            border: 2px dashed #ccc;
            padding: 20px;
            text-align: center;
            width: 300px;
            background-color: #fff;
        }
        #drop-area.highlight {
            border-color: #000;
        }
    </style>
</head>
<body>

<div id="drop-area">
    <p>Arraste e solte suas imagens aqui</p>
    <input type="file" id="fileElem" multiple accept="image/*" style="display:none">
    <label class="button" for="fileElem">Selecione arquivos</label>
</div>

<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-storage.js"></script>
<script>
    // Substitua pelas suas credenciais do Firebase
    const firebaseConfig = {
        apiKey: "SUA_API_KEY",
        authDomain: "SEU_AUTH_DOMAIN",
        projectId: "SEU_PROJECT_ID",
        storageBucket: "SEU_STORAGE_BUCKET",
        messagingSenderId: "SEU_MESSAGING_SENDER_ID",
        appId: "SEU_APP_ID"
    };

    // Inicializa o Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const storage = firebase.storage();

    const dropArea = document.getElementById('drop-area');
    const fileElem = document.getElementById('fileElem');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.add('highlight'), false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.remove('highlight'), false);
    });

    dropArea.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;

        handleFiles(files);
    }

    fileElem.addEventListener('change', () => {
        handleFiles(fileElem.files);
    });

    function handleFiles(files) {
        [...files].forEach(uploadFile);
    }

    function uploadFile(file) {
        const storageRef = storage.ref(`images/${file.name}`);
        const uploadTask = storageRef.put(file);

        uploadTask.on('state_changed',
            (snapshot) => {
                // Progresso do upload
            },
            (error) => {
                console.error('Erro ao fazer upload:', error);
            },
            () => {
                // Upload concluído
                uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                    console.log('Arquivo disponível em:', downloadURL);
                    saveImageToDatabase(downloadURL);
                });
            }
        );
    }

    function saveImageToDatabase(url) {
        // Salva a URL da imagem no banco de dados (opcional)
        fetch('/save-image', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ url })
        })
        .then(response => response.json())
        .then(data => {
            console.log('Imagem salva:', data);
        })
        .catch(error => {
            console.error('Erro ao salvar imagem:', error);
        });
    }
</script>

</body>
</html>
